# Phone Region Identifier

Этот проект представляет собой скрипт на Python, который определяет регион для каждого телефонного номера на основе предоставленных данных. Проект состоит из трех файлов: `run.py`, `make_groups.py` и `define_region.py`.

## Описание файлов

### 1. run.py

Скрипт `run.py` выполняет основную работу по обработке данных и определению региона для каждого номера телефона. Он импортирует необходимые функции из файлов `make_groups.py` и `define_region.py`.

#### Логика работы:

1. Загружает данные из файла `юникод_400.xlsx`, содержащего распределение номеров по регионам, и группирует их для оптимизации времени поиска, используя функцию `make_groups`. В результате формируется новый файл `оптимизированная_таблица.xlsx`
2. Читает файл `Номера.xlsx`, содержащий список телефонных номеров.
3. Загружает ранее созданный файл `оптимизированная_таблица.xlsx`.
4. Определяет регион для каждого номера телефона, применяя функцию `define_region`.
5. Сохраняет результат в новый файл Excel `Результат_янв_фев_4.xlsx`.

### 2. make_groups.py

Файл `make_groups.py` содержит функцию `make_groups`, которая группирует диапазоны номеров для ускорения последующего поиска регионов.

#### Логика работы функции:

1. Загружает данные из файла Excel.
2. Итерирует по строкам и формирует группы на основе условий:
   - Номера в одной группе имеют одинаковый префикс (АВС/ DEF).
   - Диапазоны номеров последовательны и принадлежат одному региону.
3. Сохраняет результат в новый файл `оптимизированная_таблица.xlsx`.

### 3. define_region.py

Файл `define_region.py` содержит функцию `define_region`, которая определяет регион для заданного номера телефона.

#### Логика работы функции:

1. Преобразует номер телефона в строку и исключает первую цифру (обычно 7 или 8).
2. Итерирует по строкам оптимизированного файла, где префикс номера совпадает с первыми тремя цифрами текущего номера.
3. Проверяет, попадает ли номер в диапазон, соответствующий текущей строке.
4. Возвращает регион, если номер соответствует диапазону, иначе возвращает 'Регион не найден'.

## Пример использования

1. Убедитесь, что у вас установлены все необходимые зависимости. Вы можете установить их с помощью команды:
    ```bash
    pip install pandas
    ```

2. Поместите файлы `юникод_400.xlsx` и `Номера.xlsx` в ту же директорию, где находятся скрипты.

3. Запустите `run.py`:
    ```bash
    python run.py
    ```

4. Результаты будут сохранены в файл `Результат_янв_фев_4.xlsx`.

## Пример файлов

- `Номера.xlsx`: файл с одним столбцом "Номера", содержащим телефонные номера.
- `юникод_400.xlsx`: файл с данными о распределении номеров по регионам, содержащий столбцы "АВС/ DEF", "От", "До", "Регион".

## Лицензия

Этот проект лицензирован под лицензией MIT. Подробности см. в файле [LICENSE](LICENSE).

